# --- Impostazioni Generali ---
max_iterations: 20
random_seed: 42
log_level: "INFO"

# --- Impostazioni di Evoluzione ---
diff_based_evolution: false  # L'LLM riscrive l'intera funzione, più stabile per modelli piccoli

# --- Configurazione LLM (Ollama) ---
llm:
  models:
    - name: "gemma3:12b"  # Assicurati di averlo pullato: ollama pull gemma3:4b
      weight: 1.0
  
  api_base: "http://localhost:11434/v1"
  api_key: "ollama"
  
  temperature: 0.8 # Un po' di creatività serve per uscire dal random
  timeout: 500
  retries: 3

prompt:
  system_message: |
    You are an EVOLUTIONARY CODING ENGINE.
    
    # THE INPUT
    You will receive a Python function `get_action(observation)`.
    
    # YOUR MISSION
    The agent controls a chicken trying to cross a highway.
    **IMPORTANT**: In this version, there are TWO chickens. We control the LEFT one.
    
    # PHYSICS & SENSORS
    - obs[0]: Chicken Y Position (0.0=Bottom, 1.0=Top).
    - obs[1] to obs[10]: Absolute X Position of the nearest car in that lane.
      - 0.0 = Far Left border.
      - 1.0 = Far Right border.
    
    # CRITICAL CONFIGURATION
    - **CHICKEN X POSITION**: The chicken is fixed at **X = 0.25** (Left side).
    
    # LOGIC HINTS (USE THIS LOGIC)
    1. IDENTIFY LANE: 
       `current_lane = int(observation[0] * 10)` (clamp between 0 and 9).
       
    2. GET CAR POSITION: 
       `car_x = observation[1 + current_lane]`
       
    3. CALCULATE SAFETY (The most important part):
       - The chicken is at 0.25.
       - The car hits the chicken if it is between **0.15** and **0.35**.
       - Logic: `if 0.15 < car_x < 0.35: return 0 (WAIT)`
       - `else: return 1 (MOVE UP)`
    
    # RULES
    - Do NOT import external libraries.
    - Implement the safety check around X=0.25.
    - Return ONLY the executable Python code.
    
  include_artifacts: true
  num_top_programs: 1
  num_diverse_programs: 2  # Chiediamo 2 varianti per ogni iterazione

# --- Configurazione Database (MAP-Elites) ---
database:
  population_size: 100   # 100 è un buon compromesso per test veloci
  num_islands: 1
  
  feature_dimensions:
    - "complexity"       # Lunghezza codice / Complessità ciclomatica
    - "score"            # Punteggio fitness
  feature_bins: 5

# --- Configurazione Valutatore ---
evaluator:
  timeout: 300
  cascade_evaluation: false
  use_llm_feedback: false
  parallel_evaluations: 1 # Con Ollama locale, meglio 1 alla volta se la GPU è satura